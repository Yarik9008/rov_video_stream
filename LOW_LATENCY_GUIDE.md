# Руководство по настройке низкой задержки

## Проблема: Видео лагает

Если видео сильно лагает, используйте следующие настройки для оптимальной передачи.

## Рекомендуемые настройки

### Минимальная задержка (по умолчанию)

```bash
python server.py --host 0.0.0.0 --low-latency
```

**Параметры:**
- Разрешение: 1080p (1920x1080)
- FPS: 30
- Битрейт: ~9-10 Mbps (автоматически)
- Задержка: минимальная

### Средняя задержка + хорошее качество

```bash
python server.py --host 0.0.0.0 --low-latency --width 1920 --height 1080 --fps 30 --bitrate 15000
```

**Параметры:**
- Разрешение: 1080p
- FPS: 30
- Битрейт: 15 Mbps
- Задержка: низкая

### Максимальное качество (большая задержка)

```bash
python server.py --host 0.0.0.0 --max-quality --no-low-latency --fps 60
```

**Параметры:**
- Разрешение: автоматическое (нативное)
- FPS: 60
- Битрейт: ~31+ Mbps (автоматически)
- Задержка: высокая

## Что изменилось

### Оптимизации для низкой задержки:

1. **Уменьшена задержка обработки кадров**
   - С 1ms до 0.1ms между опросами новых кадров
   
2. **Новый режим `--low-latency`**
   - Включен по умолчанию
   - Оптимальный битрейт для баланса качество/задержка
   - Для 1080p@30fps: ~9-10 Mbps

3. **Приоритет видеопотока**
   - Установлен высокий приоритет для RTP пакетов
   
4. **Настройки по умолчанию изменены**
   - Разрешение: 1080p (было 4K)
   - Битрейт: 10 Mbps (было 200 Mbps)

## Сравнение режимов

| Режим | Разрешение | FPS | Битрейт | Задержка | Качество |
|-------|-----------|-----|---------|----------|----------|
| Low Latency | 1080p | 30 | 10 Mbps | Минимальная | Хорошее |
| Сбалансированный | 1080p | 30 | 15 Mbps | Низкая | Очень хорошее |
| Max Quality | 4K | 60 | 250 Mbps | Высокая | Максимальное |

## Дополнительные советы

### Если всё ещё лагает:

1. **Уменьшите разрешение до 720p:**
   ```bash
   python server.py --host 0.0.0.0 --low-latency --width 1280 --height 720
   ```

2. **Уменьшите FPS до 24:**
   ```bash
   python server.py --host 0.0.0.0 --low-latency --fps 24
   ```

3. **Уменьшите битрейт:**
   ```bash
   python server.py --host 0.0.0.0 --low-latency --bitrate 5000
   ```

### Проверка сети:

```bash
# Проверка пинга (должно быть < 5ms в локальной сети)
ping <IP_сервера>

# Проверка пропускной способности
# Для 1080p@30fps нужно минимум 15 Mbps
```

## Запуск клиента

Клиент не требует специальных настроек:

```bash
python client.py --auto
```

Или с GUI:

```bash
python client_qt.py --auto
```
